import{c as g,K as C,i as P,j as e,b as v,h as R,B as _,k as $,A as L}from"./index-BFo7XKRf.js";import{u as w}from"./useUserQuery-CncwkgV4.js";import{P as S}from"./page-layout-BdntheY7.js";import{L as q,D as z}from"./LazyImage-FGEbE0FS.js";import{T as A}from"./Time-Bazugq8u.js";import"./useQuery-CF145vFH.js";import"./useBaseQuery-CN1hA8OF.js";const H=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],E=g("circle-play",H);const B=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],D=g("share-2",B);const M=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],O=g("timer",M),U=(s,t)=>s==="WEIGHTED_SCALE"?t.reduce((c,o)=>{let n=0;return o.options.forEach(d=>{n=Math.max(d?.weight||0,n)}),c+n},0):t.length,V=({sessionId:s,quizTitle:t,score:c,totalPoints:o})=>{C(`${P}?startapp=${s}splitcompleted`,`Мой результат в тесте: ${t} ${c} из ${o}`)},W="_container_xb59d_1",G="_background_xb59d_7",K="_circle_xb59d_11",x={container:W,background:G,circle:K},a=["rgb(240 102 0)","rgb(234 225 19)","rgb(3 232 246)","rgb(3 236 170)"],Q=s=>s>=75?a[3]:s>=50?a[2]:s>=25?a[1]:a[0],F=s=>s>=75?a[0]:s>=50?a[1]:s>=25?a[2]:a[3],l=251,J=({isPositive:s=!0,percentage:t=0})=>{const c=Math.max(0,Math.min(100,t)),o=l-c/100*l,n=s?Q(c):F(c);return e.jsx("div",{className:x.container,children:e.jsxs("svg",{className:"progress-ring",width:"100%",height:"100%",viewBox:"0 0 100 100",version:"1.1",style:{"--circumference-value":l,"--offset-value":o},children:[e.jsx("defs",{children:e.jsx("filter",{id:"svgRegisteringColor",children:e.jsx("feDropShadow",{dx:"0",dy:"0",stdDeviation:"2",floodColor:n})})}),e.jsx("circle",{className:v(x.background),strokeWidth:"5",fill:"transparent",r:"40",cx:"50",cy:"50"}),e.jsx("circle",{className:x.circle,strokeWidth:"5",fill:"transparent",stroke:n,r:"40",cx:"50",cy:"50",strokeDasharray:l,strokeDashoffset:o,strokeLinecap:"round",filter:"url(#svgRegisteringColor)"})]})})},X="_container_13kdc_1",Y="_barsItem_13kdc_7",Z="_barsItemTitle_13kdc_11",ee="_barsItemRow_13kdc_17",se="_barsItemLine_13kdc_23",te="_barsItemProgress_13kdc_32",re="_barsItemValue_13kdc_40",ce="_barsItemCount_13kdc_52",i={container:X,barsItem:Y,barsItemTitle:Z,barsItemRow:ee,barsItemLine:se,barsItemProgress:te,barsItemValue:re,barsItemCount:ce},ne=({categoryStatistic:s})=>e.jsx("div",{className:i.container,children:s.map((t,c)=>e.jsxs("div",{className:i.barsItem,children:[e.jsx("p",{className:i.barsItemTitle,children:t.title}),e.jsxs("div",{className:i.barsItemRow,children:[e.jsx("div",{className:i.barsItemLine,children:e.jsx("div",{className:i.barsItemProgress,style:{width:`${t.value/t.count*100}%`,animationDelay:`${c*100}ms`},children:e.jsx("p",{className:i.barsItemValue,children:t.value})})}),e.jsx("p",{className:i.barsItemCount,children:t.count})]})]},t.id))}),oe="_container_12nd8_1",ie="_title_12nd8_5",ae="_poster_12nd8_12",le="_resultHeader_12nd8_16",de="_resultInfo_12nd8_23",ue="_resultTitle_12nd8_31",me="_resultTime_12nd8_36",_e="_resultTimeIcon_12nd8_42",xe="_resultCategory_12nd8_47",ge="_resultProgress_12nd8_55",he="_resultProgressText_12nd8_62",be="_resultTextResult_12nd8_68",fe="_resultTextCount_12nd8_74",Ie="_actions_12nd8_80",je="_feedbackNotice_12nd8_86",r={container:oe,title:ie,poster:ae,resultHeader:le,resultInfo:de,resultTitle:ue,resultTime:me,resultTimeIcon:_e,resultCategory:xe,resultProgress:ge,resultProgressText:he,resultTextResult:be,resultTextCount:fe,actions:Ie,feedbackNotice:je};function ve({sessionData:s}){const{data:t}=w(),{id:c,userId:o,quizId:n,score:d,feedback:h,finalCategory:p,scoringAlgorithm:b,feedbackNotice:f,categoryStatistic:I,quiz:{title:u,questions:y,poster:j}}=s,k=o===t?.id,m=U(b,y),N=(d||0)/m*100,T=L.includes(b);return e.jsx(S,{children:e.jsxs("div",{className:r.container,children:[e.jsx("p",{className:r.title,children:u}),e.jsxs("div",{className:r.resultHeader,children:[j&&e.jsx(q,{className:r.poster,image:R(j),title:u}),e.jsxs("div",{className:r.resultInfo,children:[e.jsx("p",{className:r.resultTitle,children:"Результат"}),T?e.jsxs("div",{className:r.resultProgress,children:[e.jsx(J,{isPositive:s.quiz.resultPositive,percentage:N}),e.jsxs("p",{className:r.resultProgressText,children:[e.jsx("span",{className:r.resultTextResult,children:s.score})," / ",e.jsx("span",{className:r.resultTextCount,children:m})]})]}):e.jsx("p",{className:r.resultCategory,children:p}),e.jsxs("div",{className:r.resultTime,children:[e.jsx(O,{className:r.resultTimeIcon}),e.jsx(A,{seconds:s.timeSpentSeconds})]})]})]}),!!I?.length&&e.jsx(ne,{categoryStatistic:I}),f&&e.jsx("p",{className:r.feedbackNotice,children:f}),h&&e.jsx(z,{text:h}),k?e.jsxs("div",{className:r.actions,children:[e.jsx(_,{to:`/quiz/${n}`,after:e.jsx($,{}),children:"Повторить"}),e.jsx(_,{after:e.jsx(D,{}),onClick:()=>V({sessionId:c,quizTitle:u,score:s.score,totalPoints:m}),children:"Поделиться результатом"})]}):e.jsx(_,{to:`/quiz/${n}`,after:e.jsx(E,{}),children:"Пройти тест"})]})})}export{ve as default};

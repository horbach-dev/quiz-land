import{r as a,J as O,u as S,a as b,j as e,n as P,b as R,C as N,c as v,m as g,d as $,A as k,O as I,L as T,S as M}from"./index-Dsplwb75.js";import{c as j,u as W,a as E,B}from"./buildUrl-DgzsE-QD.js";import{C as X}from"./circle-check-big-BzI3rg6J.js";import{r as z}from"./index-CCD67qrZ.js";import{u as q,r as H}from"./popupStore-FpVJPl1w.js";import{B as V}from"./Background-CcRuozii.js";import"./trash-2-Cy1bG3Ib.js";function C(s){return a.useMemo(()=>O(),[s])}const D=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Y=j("chevron-left",D);const F=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],L=j("house",F);const G=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],J=j("user",G),U=[{id:1,title:"navigation.main",icon:L,link:"/"},{id:2,title:"navigation.quizzes",icon:X,link:"/quizzes"},{id:3,title:"navigation.profile",icon:J,link:"/profile"}],K="_container_zrlhr_1",Q="_list_zrlhr_16",Z="_hide_zrlhr_51",tt="_item_zrlhr_55",et="_active_zrlhr_84",st="_icon_zrlhr_88",p={container:K,list:Q,hide:Z,item:tt,active:et,icon:st},nt=()=>{const{t:s}=W(),t=a.useRef(null),n=S(o=>o.isNavigationVisible),{pathname:r}=b();return a.useLayoutEffect(()=>{t?.current?.offsetHeight&&document.documentElement.style.setProperty("--navigation-height",t.current.offsetHeight+"px")},[]),e.jsx("div",{className:E(p.container,!n&&p.hide),children:e.jsx("div",{ref:t,className:p.list,children:U.map(({id:o,link:c,title:i,icon:l})=>{const h=r.includes(c)&&c!=="/"||r===c;return e.jsxs("button",{type:"button",className:E(p.item,h&&p.active),onClick:()=>P(c),children:[e.jsx(l,{className:p.icon}),s(i)]},o)})})})},ot="_popup_zz4ur_1",rt="_popupOverlay_zz4ur_11",ct="_popupWrap_zz4ur_21",at="_popupContent_zz4ur_32",it="_popupClose_zz4ur_42",ut="_popupOpen_zz4ur_50",d={popup:ot,popupOverlay:rt,popupWrap:ct,popupContent:at,popupClose:it,popupOpen:ut},lt=300,pt=({isOpen:s,children:t,onClose:n})=>{const[r,o]=a.useState(!1);return a.useEffect(()=>{s?(document.body.style.overflow="hidden",o(!0)):(document.body.style.overflow="",setTimeout(()=>o(!1),lt))},[s]),r?e.jsxs("div",{className:E(d.popup,s?d.popupOpen:d.popupClose),children:[e.jsx("div",{className:d.popupOverlay,onClick:n}),e.jsx("div",{className:d.popupWrap,children:e.jsx("div",{className:d.popupContent,children:t})})]}):null},dt=document.getElementById("modals"),mt=()=>{const s=q(t=>t.popups);return z.createPortal(s.toSorted((t,n)=>t.lastOpen-n.lastOpen).map(({name:t,isOpen:n,close:r,params:o})=>{const c=H[t];return c?e.jsx(pt,{isOpen:n,onClose:()=>o?.overlayClose?r():null,children:e.jsx(c,{close:r,...o})},t):null}),dt)},ft=(s,t=300)=>{let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>s(...r),t)}},w=()=>({width:window.innerWidth,height:window.innerHeight}),ht=()=>{const[s,t]=a.useState(w);return a.useEffect(()=>{const n=ft(()=>t(w));return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),s},_t="_container_1xqeb_1",vt={container:_t},yt=document.getElementById("modals"),xt=()=>{const{width:s,height:t}=ht();return t>s+t/4?null:z.createPortal(e.jsx("div",{className:vt.container,children:e.jsxs("p",{children:["Пожалуйста ",e.jsx("br",{})," поверните устройство"]})}),yt)},m=document.getElementById("root"),y=85,f=20,Et=(s,t)=>{a.useEffect(()=>{if(!t)return;let n=0,r=0,o=0,c=0;function i(u){r=u.touches[0].clientX,n=u.touches[0].clientY,o=0,c=0}function l(u){if(o=u.touches[0].clientX,c=u.touches[0].clientY,s.current){s.current.style.transition="none";const _=o-r-Math.abs(c-n)-f;if(_<f)s.current.style.transform=`translateX(${_}px)`;else{const A=Math.min((_-f)*2,y);s.current.style.transform=`scale(${A/(y*2)+1}) translateX(${f}px)`}}}function h(){if(s.current&&(s.current.style.transition="transform 0.3s",s.current.style.transform="translateX(0) scale(1)"),o===0)return;const u=o-r-Math.abs(c-n)-f;Math.abs(u)>y&&u>0&&t&&t(),r=0,n=0,o=0,c=0}return m.addEventListener("touchstart",i),m.addEventListener("touchmove",l),m.addEventListener("touchend",h),()=>{m.removeEventListener("touchstart",i),m.removeEventListener("touchmove",l),m.removeEventListener("touchend",h)}},[t])},jt="_container_1umyf_1",zt={container:jt},Nt=document.getElementById("swipe"),gt=()=>{const s=S(n=>n.swipeRedirectCallback),t=a.useRef(null);return Et(t,s),z.createPortal(e.jsx("div",{className:zt.container,ref:t,children:e.jsx(Y,{})}),Nt)},wt="_layout_ae4of_1",St={layout:wt},bt="_container_6c4yr_1",Ct="_title_6c4yr_14",Lt="_description_6c4yr_18",x={container:bt,title:Ct,description:Lt},At=()=>e.jsxs("div",{className:x.container,children:[e.jsx("h2",{className:x.title,children:"Произошла обшика"}),e.jsxs("p",{className:x.description,children:["Непредвиденный сбой в приложении. ",e.jsx("br",{})," Либо, вы пытаетесь открыть приложение вне телеграм"]}),e.jsx(B,{after:e.jsx(L,{}),to:"/",children:"На главную"})]});function Ot(){const[s,t]=a.useState(!1),{tgWebAppStartParam:n}=C(),r=R(),{pathname:o}=b();function c({detail:i}){i?.pathname!==o&&i?.pathname&&r(i.pathname==="back-navigate"?-1:i.pathname)}return a.useEffect(()=>{if(n&&!s){t(!0);const[i,l]=n.replaceAll('"',"").split("/");l==="start"&&r(`quiz/${i}`),l==="completed"&&r(`quiz-result/${i}`)}},[n,s,r]),a.useEffect(()=>(document.addEventListener(N,c),()=>{document.removeEventListener(N,c)}),[o]),{pathname:o}}const Pt=["ios","android"];function Rt(){const{tgWebAppPlatform:s}=C(),t=Pt.includes(s);return a.useLayoutEffect(()=>{v?.isSupported()&&(v?.mount(),v?.disableVertical()),t&&g.requestFullscreen?.isAvailable()&&g.requestFullscreen()},[t]),{isMobile:t}}function Xt(){const s=$(),{pathname:t}=Ot(),{isMobile:n}=Rt();return e.jsxs(e.Fragment,{children:[e.jsx(V,{}),e.jsx("div",{className:St.layout,children:e.jsx(a.Suspense,{fallback:e.jsx(T,{}),children:e.jsx(k,{resolve:s.userData,errorElement:e.jsx(At,{}),children:e.jsx(I,{})})})}),e.jsx(M,{}),e.jsx(nt,{}),t!=="/"&&e.jsx(gt,{}),n&&t!=="/create"&&e.jsx(xt,{}),e.jsx(mt,{})]})}export{Xt as default};

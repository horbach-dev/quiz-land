import{c as A,f as y,g as _,r as o,j as e,B as i,h as w}from"./index-CpQMeG-6.js";import{Q,a as R}from"./QuizList-C-jYsfVn.js";import{P as b}from"./page-layout-DDA38ITa.js";import{S as P}from"./SectionHeader-BQA1bP0Y.js";import{u as g}from"./useMutation-Cc2gD297.js";import{u as S}from"./useClickOutside-BMreMyUm.js";import{S as v}from"./square-pen-DyJzQmAs.js";import{T as L}from"./trash-2-BB9ukT4O.js";import{u as I}from"./useUserQuery-BKKYHF8J.js";import{A as $}from"./index-DLzPLipo.js";import{u as q}from"./useTranslation-lpBjxsq-.js";import"./useBaseQuery-Cf-xLxfk.js";import"./useQuery-BboL5dku.js";const H=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],U=A("globe",H),W="_container_lkrrv_1",B={container:W},D=async t=>(await y.delete(`/quiz/${t}`))?.data;function E(t){const s=_();return g({mutationFn:()=>D(t),onSuccess:()=>{s.invalidateQueries({queryKey:["getQuizList",{type:"my"}]})}})}const M="_popover_vdrbh_1",O="_popoverContent_vdrbh_5",F="_popoverActions_vdrbh_21",j={popover:M,popoverContent:O,popoverActions:F},T=({children:t,text:s,onConfirm:c,onCancel:d})=>{const[a,p]=o.useState(0),l=o.useRef(null),f=o.useRef(null),n=o.useRef(null),[m,u]=o.useState(!1),C=()=>{u(!1),c()},k=()=>{u(!1),d?.()},z=()=>{p(window.innerWidth),u(h=>!h)};return o.useLayoutEffect(()=>{if(f.current&&n.current&&m){const{left:h,width:x}=n.current.getBoundingClientRect(),{width:N}=f.current.getBoundingClientRect();if(n.current.style.bottom="calc(100% + 0.7rem)",a-h-x<20){n.current.style.right="0";return}n.current.style.left=`calc(-${x/2-N/2}px)`}},[m,a]),S({ref:l,onClickOutside:()=>u(!1)}),e.jsxs("div",{ref:l,className:j.popover,children:[m&&e.jsxs("div",{ref:n,className:j.popoverContent,children:[s,e.jsxs("div",{className:j.popoverActions,children:[e.jsx(i,{style:"default",size:"sm",onClick:C,children:"Да"}),e.jsx(i,{style:"white",size:"sm",onClick:k,children:"Нет"})]})]}),e.jsx("div",{onClick:z,ref:f,children:t})]})},K="_cardActions_13057_1",G={cardActions:K},J=({item:t})=>{const{mutate:s,isPending:c}=E(t.id);return e.jsxs("div",{className:G.cardActions,children:[e.jsx(i,{size:"sm",style:"icon",to:`/edit/${t.id}`,children:e.jsx(v,{})}),e.jsx(T,{onConfirm:s,text:e.jsxs(e.Fragment,{children:["Удалить ",e.jsx("br",{})," ",t.title," ?"]}),children:e.jsx(i,{size:"sm",style:"icon",loading:c,type:"button",children:e.jsx(L,{})})})]})},V=async t=>(await y.patch("/user",t)).data;function X(){const t=_();return g({mutationFn:V,onSuccess:s=>{t.setQueryData(["getUserData"],s)}})}const Y="_profileHeader_ji570_1",Z="_profileInfo_ji570_7",ee="_profileContent_ji570_12",te="_nick_ji570_16",se="_line_ji570_22",r={profileHeader:Y,profileInfo:Z,profileContent:ee,nick:te,line:se},ne=()=>{const{i18n:t}=q(),{data:s}=I(),{mutateAsync:c,isPending:d}=X(),a=async()=>{const p=s?.language==="ru"?"en":"ru";c({language:p}).then(l=>{t.changeLanguage(l.language)})};return e.jsxs("div",{className:r.profileHeader,children:[e.jsxs("div",{className:r.profileInfo,children:[e.jsx($,{image:s?.avatar}),e.jsxs("div",{className:r.profileContent,children:[e.jsx("p",{className:r.nick,children:s?.first_name||s?.username}),e.jsx("p",{className:r.line,children:"Создано: 0"}),e.jsx("p",{className:r.line,children:"Пройдено: 0"})]})]}),e.jsx(i,{size:"sm",auto:!0,loading:d,onClick:a,after:e.jsx(U,{}),children:s?.language==="ru"?"EN":"RU"})]})};function xe(){return e.jsx(b,{children:e.jsxs("div",{className:B.container,children:[e.jsx(ne,{}),e.jsx(P,{title:"Созданные квизы",actions:e.jsx(i,{size:"sm",to:"/create",after:e.jsx(v,{}),children:"Новый"})}),e.jsx(Q,{listKey:"profile-page",params:{type:"my"},renderItem:({data:t})=>e.jsx(R,{image:w(t.poster),title:t.title,link:`quiz/${t.id}`,actions:e.jsx(J,{item:t})},t.id)})]})})}export{xe as default};

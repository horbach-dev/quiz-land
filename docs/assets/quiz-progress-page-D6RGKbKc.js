import{c as Z,j as f,d as U,M as _,r as g,B as Ce,e as Ne,f as Ie,P as Le}from"./index-CxWIOCeG.js";const Se=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],$e=Z("chevrons-left",Se);const Ae=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],Re=Z("chevrons-right",Ae);const qe=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],Pe=Z("flag",qe),De="_progressWrap_38du3_1",Ye="_progressIcon_38du3_9",He="_progress_38du3_1",Te="_progressTrack_38du3_24",ze="_hide_38du3_34",q={progressWrap:De,progressIcon:Ye,progress:He,progressTrack:Te,hide:ze},We=({isShow:i=!0,step:a,length:u})=>{const l=`${(a+1)/u*100}%`;return f.jsxs("div",{className:U(q.progressWrap,!i&&q.hide),children:[f.jsx("div",{className:q.progress,children:f.jsx("div",{style:{width:l},className:q.progressTrack})}),f.jsx(Pe,{className:q.progressIcon})]})};function fe(i){let a=_.useRef(i);return _.useEffect(()=>{a.current=i}),_.useMemo(()=>(...u)=>{var l;return(l=a.current)==null?void 0:l.call(a,...u)},[])}function Qe({defaultProp:i,onChange:a}){let u=_.useState(i),[l]=u,o=_.useRef(l),m=fe(a);return _.useEffect(()=>{o.current!==l&&(m(l),o.current=l)},[l,o,m]),u}function Fe({prop:i,defaultProp:a,onChange:u=()=>{}}){let[l,o]=Qe({defaultProp:a,onChange:u}),m=i!==void 0,b=m?i:l,N=fe(u),S=_.useCallback(v=>{if(m){let j=typeof v=="function"?v(i):v;j!==i&&N(j)}else o(v)},[m,i,o,N]);return[b,S]}var ce=.3,Oe=30,Ve=i=>Math.pow(i-1,3)+1,B=(i,a,u)=>Math.max(a,Math.min(i,u)),Be=({className:i,children:a})=>_.createElement("div",{className:i,"data-rwp-wrapper":!0},a);function Ge({defaultValue:i,value:a,onValueChange:u,options:l,infinite:o=!1,visibleCount:m=20,dragSensitivity:b=3,scrollSensitivity:N=5,optionItemHeight:S=30,classNames:v}){var j;let[P=(j=l[0])==null?void 0:j.value,I]=Fe({defaultProp:i,prop:a,onChange:u}),c=g.useMemo(()=>{if(!o)return l;let e=[],t=Math.ceil(m/2);if(l.length===0)return e;for(;e.length<t;)e.push(...l);return e},[m,l,o]),p=S,k=p*.5,M=360/m,D=p/Math.tan(M*Math.PI/180),ge=Math.round(D*2+p*.25),C=m>>2,J=b*10,pe=10,x=g.useRef(null),Y=g.useRef(null),z=g.useRef(null),y=g.useRef(0),K=g.useRef(0),L=g.useRef(!1),ee=g.useRef(0),W=g.useRef({startY:0,yList:[],touchScroll:0,isClick:!0}),Q=g.useRef(null),me=g.useMemo(()=>{let e=(n,r,s)=>_.createElement("li",{key:r,className:v?.optionItem,"data-slot":"option-item","data-rwp-option":!0,"data-index":r,style:{top:-k,height:p,lineHeight:`${p}px`,transform:`rotateX(${s}deg) translateZ(${D}px)`,visibility:"hidden"}},n.label),t=c.map((n,r)=>e(n,r,-M*r));if(o)for(let n=0;n<C;++n){let r=-n-1,s=n+c.length;t.unshift(e(c[c.length-n-1],r,M*(n+1))),t.push(e(c[n],s,-M*s))}return t},[p,k,o,M,c,C,D,v?.optionItem]),ve=g.useMemo(()=>{let e=(n,r)=>_.createElement("li",{key:r,className:v?.highlightItem,"data-slot":"highlight-item","data-rwp-highlight-item":!0,style:{height:p}},n.label),t=c.map((n,r)=>e(n,r));if(o){let n=c[0],r=c[c.length-1];t.unshift(e(r,"infinite-start")),t.push(e(n,"infinite-end"))}return t},[v?.highlightItem,p,o,c]),_e=g.useMemo(()=>{let e=0,t=Math.PI/180,n=[];for(let r=C-1;r>=-C+1;--r){let s=r*M,d=p*Math.cos(s*t),h=e;e+=d,n.push([h,e])}return n},[M,p,C]),F=e=>(e%c.length+c.length)%c.length,$=e=>{let t=o?F(e):e;if(Y.current){let n=`translateZ(${-D}px) rotateX(${M*t}deg)`;Y.current.style.transform=n,Y.current.childNodes.forEach(r=>{let s=r,d=Math.abs(Number(s.dataset.index)-t);s.style.visibility=d>C?"hidden":"visible"})}return z.current&&(z.current.style.transform=`translateY(${-t*p}px)`),t},H=()=>{cancelAnimationFrame(K.current)},te=(e,t,n,r)=>{if(e===t||n===0){$(e);return}let s=performance.now(),d=t-e,h=E=>{let w=(E-s)/1e3;if(w<n){let V=Ve(w/n);y.current=$(e+V*d),K.current=requestAnimationFrame(h)}else H(),y.current=$(t),r?.()};requestAnimationFrame(h)},T=e=>{let t=F(e)|0,n=o?t:Math.min(Math.max(t,0),c.length-1);if(!o&&n!==e)return;y.current=$(n);let r=c[y.current];I(r.value)},xe=e=>{let t=c.findIndex(n=>n.value===e);if(t===-1){console.error("Invalid value selected:",e);return}H(),T(t)},ne=e=>{let t=y.current,n=t+e;o?n=Math.round(n):n=B(Math.round(n),0,c.length-1);let r=Math.abs(n-t);if(r===0)return;let s=Math.sqrt(r/N);H(),te(t,n,s,()=>{T(y.current)})},ye=e=>{let t=x.current;if(!t){console.error("Container reference is not set.");return}let{top:n}=t.getBoundingClientRect(),r=e-n,s=_e.findIndex(([h,E])=>r>=h&&r<=E);if(s===-1){console.error("No item found for click position:",r);return}let d=(C-s-1)*-1;ne(d)},Ee=e=>{var t,n;try{let r=(e instanceof MouseEvent?e.clientY:(n=(t=e.touches)==null?void 0:t[0])==null?void 0:n.clientY)||0,s=W.current;s.isClick&&Math.abs(r-s.startY)>5&&(s.isClick=!1),s.yList.push([r,Date.now()]),s.yList.length>5&&s.yList.shift();let d=(s.startY-r)/p,h=y.current+d;if(o)h=F(h);else{let E=c.length;h<0?h*=ce:h>E&&(h=E+(h-E)*ce)}s.touchScroll=$(h)}catch(r){console.error("Error in updateScrollDuringDrag:",r)}},re=e=>{var t;!L.current&&!((t=x.current)!=null&&t.contains(e.target))&&e.target!==x.current||(e.cancelable&&e.preventDefault(),c.length&&Ee(e))},se=e=>{var t,n,r;try{L.current=!0;let s=new AbortController,{signal:d}=s;Q.current=s;let h={signal:d,passive:!1};(t=x.current)==null||t.addEventListener("touchmove",re,h),document.addEventListener("mousemove",re,h);let E=(e instanceof MouseEvent?e.clientY:(r=(n=e.touches)==null?void 0:n[0])==null?void 0:r.clientY)||0,w=W.current;w.startY=E,w.yList=[[E,Date.now()]],w.touchScroll=y.current,w.isClick=!0,H()}catch(s){console.error("Error in initiateDragGesture:",s)}},A=g.useCallback(e=>{var t;let n=L.current,r=!!((t=x.current)!=null&&t.contains(e.target))||e.target===x.current;(n||r)&&e.cancelable&&(e.preventDefault(),c.length&&se(e))},[se]),Me=e=>{let t=y.current,n=t,r=e>0?-J:J,s=0;if(o){s=Math.abs(e/r);let d=e*s+.5*r*s*s;n=Math.round(t+d)}else if(t<0||t>c.length-1){let d=B(t,0,c.length-1),h=t-d;r=pe,s=Math.sqrt(Math.abs(h/r)),e=r*s,e=t>0?-e:e,n=d}else{s=Math.abs(e/r);let d=e*s+.5*r*s*s;n=Math.round(t+d),n=B(n,0,c.length-1);let h=n-t;s=Math.sqrt(Math.abs(h/r))}te(t,n,s,()=>{T(y.current)}),T(y.current)},ae=()=>{var e,t,n,r;try{(e=Q.current)==null||e.abort(),Q.current=null;let s=W.current;if(s.isClick){ye(s.startY);return}let d=s.yList,h=0;if(d.length>1){let E=d.length,[w,V]=(t=d[E-2])!=null?t:[0,0],[we,be]=(n=d[E-1])!=null?n:[0,0],ie=be-V;if(ie>0){let oe=(w-we)/p*1e3/ie,je=Oe,ke=oe>0?1:-1;h=Math.min(Math.abs(oe),je)*ke}}y.current=(r=s.touchScroll)!=null?r:y.current,Me(h)}catch(s){console.error("Error in finalizeDragAndStartInertiaScroll:",s)}finally{L.current=!1}},R=g.useCallback(e=>{var t;if(!c.length)return;let n=L.current,r=!!((t=x.current)!=null&&t.contains(e.target))||e.target===x.current;(n||r)&&e.cancelable&&(e.preventDefault(),ae())},[ae]),le=e=>{e.preventDefault();let t=Date.now();if(t-ee.current<100)return;let n=Math.sign(e.deltaY);n&&(ee.current=t,ne(n))},O=g.useCallback(e=>{if(!c.length||!x.current)return;let t=L.current,n=x.current.contains(e.target)||e.target===x.current;(t||n)&&e.cancelable&&(e.preventDefault(),le(e))},[le]);return g.useEffect(()=>{let e=x.current;if(!e)return;let t={passive:!1};return e.addEventListener("touchstart",A,t),e.addEventListener("touchend",R,t),e.addEventListener("wheel",O,t),document.addEventListener("mousedown",A,t),document.addEventListener("mouseup",R,t),()=>{e.removeEventListener("touchstart",A),e.removeEventListener("touchend",R),e.removeEventListener("wheel",O),document.removeEventListener("mousedown",A),document.removeEventListener("mouseup",R)}},[R,A,O]),g.useEffect(()=>{xe(P)},[P,a,c]),_.createElement("div",{ref:x,"data-rwp":!0,style:{height:ge}},_.createElement("ul",{ref:Y,"data-rwp-options":!0},me),_.createElement("div",{className:v?.highlightWrapper,"data-rwp-highlight-wrapper":!0,"data-slot":"highlight-wrapper",style:{height:p,lineHeight:`${p}px`}},_.createElement("ul",{ref:z,"data-rwp-highlight-list":!0,style:{top:o?-p:void 0}},ve)))}const Xe=window.innerWidth*12/100,Ze=({options:i,value:a,onValueChange:u})=>f.jsx(Be,{children:f.jsx(Ge,{options:i,optionItemHeight:Xe,value:a,onValueChange:u})}),Ue="_container_2n9kh_1",Je="_item_2n9kh_5",Ke="_itemActive_2n9kh_15",G={container:Ue,item:Je,itemActive:Ke},et=({options:i,value:a,onChange:u})=>f.jsx("div",{className:G.container,children:i.map(l=>f.jsx("div",{className:U(G.item,a===l.value&&G.itemActive),onClick:()=>u(l.value),children:l.label},l.value))}),tt="_container_15bqk_1",nt="_title_15bqk_9",rt="_hide_15bqk_15",X={container:tt,title:nt,hide:rt},st=({isShow:i,question:a,value:u,setValue:l})=>{const o=a.options.map(m=>({label:m.text,value:m.id}));return console.log(o),f.jsxs("div",{className:U(X.container,!i&&X.hide),children:[f.jsx("p",{className:X.title,children:a.text}),a.type==="MULTI_CHOICE"&&f.jsx(Ze,{onValueChange:l,options:o,value:u}),a.type==="SINGLE_CHOICE"&&f.jsx(et,{value:u,options:o,onChange:l})]})},at="_container_nu1oo_1",lt="_content_nu1oo_40",ue={container:at,content:lt},it=({disabled:i,isDone:a,onClick:u})=>f.jsx("div",{className:ue.container,children:f.jsx("div",{className:ue.content,children:f.jsx(Ce,{onClick:u,disabled:i,before:!a&&f.jsx($e,{}),after:a&&f.jsx(Re,{}),children:a?"Поделиться":"Назад"})})}),ot="_container_r7ji6_1",ct="_content_r7ji6_14",he={container:ot,content:ct},de=300,ut="1";function dt(){const{id:i}=Ne(),{data:a}=Ie(i),[u,l]=g.useState(!1),[o,m]=g.useState(0),[b,N]=g.useState(!1),[S,v]=g.useState([]),j=()=>{if(!u){if(o===(a?.questions?.length||0)-1){N(!0);return}l(!0),setTimeout(()=>{l(!1),m(k=>k+1)},de)}},P=()=>{u||o!==0&&(l(!0),setTimeout(()=>{l(!1),m(k=>k-1)},de))},I=a?.questions[o];if(!I)return null;const c=k=>{j(),v(M=>({...M,[I.id]:{value:k}}))},p=S[I.id];return f.jsx(Le,{withNavigation:!1,children:f.jsxs("div",{className:he.container,children:[f.jsxs("div",{className:he.content,children:[f.jsx(We,{step:o,isShow:!b,length:a?.questions?.length||0}),f.jsx(st,{isShow:!u&&!b,value:p?.value||"",setValue:c,question:I})]}),f.jsx(it,{id:ut,isDone:b,disabled:o===0,onClick:b?j:P})]})})}export{dt as default};

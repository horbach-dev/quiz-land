import{a as g,u as z,b as E,r as o,j as e,B as l,P as L,i as w}from"./index-BwX7s29R.js";import{u as Q,Q as S,a as A}from"./useQuizListQuery-Bdcv9atU.js";import{S as R}from"./SectionHeader-DgQ8V6Sj.js";import{S as x}from"./square-pen-B9afm_7x.js";import{T as k}from"./trash-2-BPIRyR1V.js";const P="_container_lkrrv_1",b={container:P},B=async t=>(await g.delete(`/quiz/${t}`))?.data;function W(t){const s=z();return E({mutationFn:()=>B(t),onSuccess:()=>{s.invalidateQueries({queryKey:["getQuizList",{type:"my"}]})}})}function q({onClickOutside:t,ref:s,options:n={}}){o.useEffect(()=>{const r=i=>{const d=n.excludedElementsSelector,u=d&&d.some(a=>!!i.target.closest(a));!s.current||s.current.contains(i.target)||u||t(i)};return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r)}},[n.excludedElementsSelector,s,t])}const N="_popover_vdrbh_1",$="_popoverContent_vdrbh_5",O="_popoverActions_vdrbh_21",h={popover:N,popoverContent:$,popoverActions:O},D=({children:t,text:s,onConfirm:n,onCancel:r})=>{const[i,d]=o.useState(0),u=o.useRef(null),a=o.useRef(null),c=o.useRef(null),[m,p]=o.useState(!1),j=()=>{p(!1),n()},y=()=>{p(!1),r?.()},C=()=>{d(window.innerWidth),p(f=>!f)};return o.useLayoutEffect(()=>{if(a.current&&c.current&&m){const{left:f,width:v}=c.current.getBoundingClientRect(),{width:_}=a.current.getBoundingClientRect();if(c.current.style.bottom="calc(100% + 0.7rem)",i-f-v<20){c.current.style.right="0";return}c.current.style.left=`calc(-${v/2-_/2}px)`}},[m,i]),q({ref:u,onClickOutside:()=>p(!1)}),e.jsxs("div",{ref:u,className:h.popover,children:[m&&e.jsxs("div",{ref:c,className:h.popoverContent,children:[s,e.jsxs("div",{className:h.popoverActions,children:[e.jsx(l,{style:"default",size:"sm",onClick:j,children:"Да"}),e.jsx(l,{style:"white",size:"sm",onClick:y,children:"Нет"})]})]}),e.jsx("div",{onClick:C,ref:a,children:t})]})},F="_cardActions_13057_1",I={cardActions:F},T=({item:t})=>{const{mutate:s,isPending:n}=W(t.id);return e.jsxs("div",{className:I.cardActions,children:[e.jsx(l,{size:"sm",style:"icon",children:e.jsx(x,{})}),e.jsx(D,{onConfirm:s,text:e.jsxs(e.Fragment,{children:["Удалить ",e.jsx("br",{})," ",t.title," ?"]}),children:e.jsx(l,{size:"sm",style:"icon",loading:n,children:e.jsx(k,{})})})]})};function J(){const{isLoading:t,data:s}=Q({type:"my"});return e.jsx(L,{children:e.jsxs("div",{className:b.container,children:[e.jsx(R,{title:"Созданные квизы",actions:e.jsx(l,{size:"sm",to:"/create",after:e.jsx(x,{}),children:"Новый"})}),e.jsx(S,{isLoading:t,data:s,renderItem:n=>e.jsx(A,{image:w+n.poster,title:n.title,link:`quiz/${n.id}`,actions:e.jsx(T,{item:n})},n.id)})]})})}export{J as default};

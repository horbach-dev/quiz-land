import{r as c,J as L,u as N,j as n,c as x,a as A,C as g,n as _,m as j,b as O,A as P,O as R,L as k,S as I}from"./index-BViiGnCv.js";import{c as E,u as T,a as S,n as $}from"./Button-uA8O_c__.js";import{C as M}from"./circle-check-big-DYKLA1e5.js";import{r as z}from"./index-DAwEm20B.js";import{u as W,r as X}from"./popupStore-BHZ4cIir.js";import{B}from"./Background-nXB4ips0.js";function b(t){return c.useMemo(()=>L(),[t])}const H=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],q=E("chevron-left",H);const V=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],D=E("house",V);const Y=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],F=E("user",Y),G=[{id:1,title:"navigation.main",icon:D,link:"/"},{id:2,title:"navigation.quizzes",icon:M,link:"/quizzes"},{id:3,title:"navigation.profile",icon:F,link:"/profile"}],J="_container_zrlhr_1",U="_list_zrlhr_16",K="_hide_zrlhr_51",Q="_item_zrlhr_55",Z="_active_zrlhr_84",ee="_icon_zrlhr_88",l={container:J,list:U,hide:K,item:Q,active:Z,icon:ee},te=()=>{const{t}=T(),e=c.useRef(null),s=S(o=>o.isNavigationVisible),{pathname:r}=N();return c.useLayoutEffect(()=>{e?.current?.offsetHeight&&document.documentElement.style.setProperty("--navigation-height",e.current.offsetHeight+"px")},[]),n.jsx("div",{className:x(l.container,!s&&l.hide),children:n.jsx("div",{ref:e,className:l.list,children:G.map(({id:o,link:a,title:i,icon:f})=>{const h=r.includes(a)&&a!=="/"||r===a;return n.jsxs("button",{type:"button",className:x(l.item,h&&l.active),onClick:()=>$(a),children:[n.jsx(f,{className:l.icon}),t(i)]},o)})})})},ne="_popup_zz4ur_1",se="_popupOverlay_zz4ur_11",oe="_popupWrap_zz4ur_21",re="_popupContent_zz4ur_32",ae="_popupClose_zz4ur_42",ce="_popupOpen_zz4ur_50",p={popup:ne,popupOverlay:se,popupWrap:oe,popupContent:re,popupClose:ae,popupOpen:ce},ie=300,ue=({isOpen:t,children:e,onClose:s})=>{const[r,o]=c.useState(!1);return c.useEffect(()=>{t?(document.body.style.overflow="hidden",o(!0)):(document.body.style.overflow="",setTimeout(()=>o(!1),ie))},[t]),r?n.jsxs("div",{className:x(p.popup,t?p.popupOpen:p.popupClose),children:[n.jsx("div",{className:p.popupOverlay,onClick:s}),n.jsx("div",{className:p.popupWrap,children:n.jsx("div",{className:p.popupContent,children:e})})]}):null},le=document.getElementById("modals"),pe=()=>{const t=W(e=>e.popups);return z.createPortal(t.toSorted((e,s)=>e.lastOpen-s.lastOpen).map(({name:e,isOpen:s,close:r,params:o})=>{const a=X[e];return a?n.jsx(ue,{isOpen:s,onClose:()=>o?.overlayClose?r():null,children:n.jsx(a,{close:r,...o})},e):null}),le)},de=(t,e=300)=>{let s;return(...r)=>{clearTimeout(s),s=setTimeout(()=>t(...r),e)}},w=()=>({width:window.innerWidth,height:window.innerHeight}),me=()=>{const[t,e]=c.useState(w);return c.useEffect(()=>{const s=de(()=>e(w));return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]),t},fe="_container_1xqeb_1",he={container:fe},ve=document.getElementById("modals"),_e=()=>{const{width:t,height:e}=me();return e>t+e/4?null:z.createPortal(n.jsx("div",{className:he.container,children:n.jsxs("p",{children:["Пожалуйста ",n.jsx("br",{})," поверните устройство"]})}),ve)},d=document.getElementById("root"),y=85,m=20,ye=(t,e)=>{c.useEffect(()=>{if(!e)return;let s=0,r=0,o=0,a=0;function i(u){r=u.touches[0].clientX,s=u.touches[0].clientY,o=0,a=0}function f(u){if(o=u.touches[0].clientX,a=u.touches[0].clientY,t.current){t.current.style.transition="none";const v=o-r-Math.abs(a-s)-m;if(v<m)t.current.style.transform=`translateX(${v}px)`;else{const C=Math.min((v-m)*2,y);t.current.style.transform=`scale(${C/(y*2)+1}) translateX(${m}px)`}}}function h(){if(t.current&&(t.current.style.transition="transform 0.3s",t.current.style.transform="translateX(0) scale(1)"),o===0)return;const u=o-r-Math.abs(a-s)-m;Math.abs(u)>y&&u>0&&e&&e(),r=0,s=0,o=0,a=0}return d.addEventListener("touchstart",i),d.addEventListener("touchmove",f),d.addEventListener("touchend",h),()=>{d.removeEventListener("touchstart",i),d.removeEventListener("touchmove",f),d.removeEventListener("touchend",h)}},[e])},xe="_container_1umyf_1",Ee={container:xe},ze=document.getElementById("swipe"),ge=()=>{const t=S(s=>s.swipeRedirectCallback),e=c.useRef(null);return ye(e,t),z.createPortal(n.jsx("div",{className:Ee.container,ref:e,children:n.jsx(q,{})}),ze)};function je(){const[t,e]=c.useState(!1),{tgWebAppStartParam:s}=b(),r=A(),{pathname:o}=N();function a({detail:i}){i?.pathname!==o&&i?.pathname&&r(i.pathname==="back-navigate"?-1:i.pathname)}return c.useEffect(()=>{s&&!t&&(e(!0),r(`quiz/${s}`))},[s,t,r]),c.useEffect(()=>(document.addEventListener(g,a),()=>{document.removeEventListener(g,a)}),[o]),{pathname:o}}const we=["ios","android"];function Ne(){const{tgWebAppPlatform:t}=b(),e=we.includes(t);return c.useLayoutEffect(()=>{_?.isSupported()&&(_?.mount(),_?.disableVertical()),e&&j.requestFullscreen?.isAvailable()&&j.requestFullscreen()},[e]),{isMobile:e}}const Se="_layout_1gu4l_1",be={layout:Se};function ke(){const t=O(),{pathname:e}=je(),{isMobile:s}=Ne();return n.jsxs(n.Fragment,{children:[n.jsx(B,{}),n.jsx("div",{className:be.layout,children:n.jsx(c.Suspense,{fallback:n.jsx(k,{}),children:n.jsx(P,{resolve:t.userData,errorElement:n.jsx("div",{children:"Error during render page!"}),children:n.jsx(R,{})})})}),n.jsx(I,{}),n.jsx(te,{}),e!=="/"&&n.jsx(ge,{}),s&&e!=="/create"&&n.jsx(_e,{}),n.jsx(pe,{})]})}export{ke as default};

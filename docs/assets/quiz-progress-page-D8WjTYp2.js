import{c as J,j as h,k as D,M as _,r as g,f as ke,l as Ne,B as Ie,m as Se,n as $e,P as Ae}from"./index-gNl7kJmy.js";const Re=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],Pe=J("chevrons-left",Re);const De=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],Ye=J("chevrons-right",De);const ze=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],qe=J("flag",ze),He="_progressWrap_38du3_1",Te="_progressIcon_38du3_9",We="_progress_38du3_1",Qe="_progressTrack_38du3_24",Be="_hide_38du3_34",P={progressWrap:He,progressIcon:Te,progress:We,progressTrack:Qe,hide:Be},Fe=({isShow:i=!0,step:a,length:c})=>{const o=`${(a+1)/c*100}%`;return h.jsxs("div",{className:D(P.progressWrap,!i&&P.hide),children:[h.jsx("div",{className:P.progress,children:h.jsx("div",{style:{width:o},className:P.progressTrack})}),h.jsx(qe,{className:P.progressIcon})]})};function fe(i){let a=_.useRef(i);return _.useEffect(()=>{a.current=i}),_.useMemo(()=>(...c)=>{var o;return(o=a.current)==null?void 0:o.call(a,...c)},[])}function Oe({defaultProp:i,onChange:a}){let c=_.useState(i),[o]=c,l=_.useRef(o),m=fe(a);return _.useEffect(()=>{l.current!==o&&(m(o),l.current=o)},[o,l,m]),c}function Ve({prop:i,defaultProp:a,onChange:c=()=>{}}){let[o,l]=Oe({defaultProp:a,onChange:c}),m=i!==void 0,M=m?i:o,k=fe(c),S=_.useCallback(v=>{if(m){let b=typeof v=="function"?v(i):v;b!==i&&k(b)}else l(v)},[m,i,l,k]);return[M,S]}var ue=.3,Ge=30,Ue=i=>Math.pow(i-1,3)+1,U=(i,a,c)=>Math.max(a,Math.min(i,c)),Xe=({className:i,children:a})=>_.createElement("div",{className:i,"data-rwp-wrapper":!0},a);function Ze({defaultValue:i,value:a,onValueChange:c,options:o,infinite:l=!1,visibleCount:m=20,dragSensitivity:M=3,scrollSensitivity:k=5,optionItemHeight:S=30,classNames:v}){var b;let[Y=(b=o[0])==null?void 0:b.value,N]=Ve({defaultProp:i,prop:a,onChange:c}),u=g.useMemo(()=>{if(!l)return o;let e=[],t=Math.ceil(m/2);if(o.length===0)return e;for(;e.length<t;)e.push(...o);return e},[m,o,l]),p=S,C=p*.5,L=360/m,z=p/Math.tan(L*Math.PI/180),me=Math.round(z*2+p*.25),j=m>>2,K=M*10,pe=10,x=g.useRef(null),q=g.useRef(null),Q=g.useRef(null),y=g.useRef(0),ee=g.useRef(0),I=g.useRef(!1),te=g.useRef(0),B=g.useRef({startY:0,yList:[],touchScroll:0,isClick:!0}),F=g.useRef(null),ve=g.useMemo(()=>{let e=(n,r,s)=>_.createElement("li",{key:r,className:v?.optionItem,"data-slot":"option-item","data-rwp-option":!0,"data-index":r,style:{top:-C,height:p,lineHeight:`${p}px`,transform:`rotateX(${s}deg) translateZ(${z}px)`,visibility:"hidden"}},n.label),t=u.map((n,r)=>e(n,r,-L*r));if(l)for(let n=0;n<j;++n){let r=-n-1,s=n+u.length;t.unshift(e(u[u.length-n-1],r,L*(n+1))),t.push(e(u[n],s,-L*s))}return t},[p,C,l,L,u,j,z,v?.optionItem]),_e=g.useMemo(()=>{let e=(n,r)=>_.createElement("li",{key:r,className:v?.highlightItem,"data-slot":"highlight-item","data-rwp-highlight-item":!0,style:{height:p}},n.label),t=u.map((n,r)=>e(n,r));if(l){let n=u[0],r=u[u.length-1];t.unshift(e(r,"infinite-start")),t.push(e(n,"infinite-end"))}return t},[v?.highlightItem,p,l,u]),xe=g.useMemo(()=>{let e=0,t=Math.PI/180,n=[];for(let r=j-1;r>=-j+1;--r){let s=r*L,f=p*Math.cos(s*t),d=e;e+=f,n.push([d,e])}return n},[L,p,j]),O=e=>(e%u.length+u.length)%u.length,$=e=>{let t=l?O(e):e;if(q.current){let n=`translateZ(${-z}px) rotateX(${L*t}deg)`;q.current.style.transform=n,q.current.childNodes.forEach(r=>{let s=r,f=Math.abs(Number(s.dataset.index)-t);s.style.visibility=f>j?"hidden":"visible"})}return Q.current&&(Q.current.style.transform=`translateY(${-t*p}px)`),t},H=()=>{cancelAnimationFrame(ee.current)},ne=(e,t,n,r)=>{if(e===t||n===0){$(e);return}let s=performance.now(),f=t-e,d=E=>{let w=(E-s)/1e3;if(w<n){let G=Ue(w/n);y.current=$(e+G*f),ee.current=requestAnimationFrame(d)}else H(),y.current=$(t),r?.()};requestAnimationFrame(d)},T=e=>{let t=O(e)|0,n=l?t:Math.min(Math.max(t,0),u.length-1);if(!l&&n!==e)return;y.current=$(n);let r=u[y.current];N(r.value)},ye=e=>{let t=u.findIndex(n=>n.value===e);if(t===-1){console.error("Invalid value selected:",e);return}H(),T(t)},re=e=>{let t=y.current,n=t+e;l?n=Math.round(n):n=U(Math.round(n),0,u.length-1);let r=Math.abs(n-t);if(r===0)return;let s=Math.sqrt(r/k);H(),ne(t,n,s,()=>{T(y.current)})},Ee=e=>{let t=x.current;if(!t){console.error("Container reference is not set.");return}let{top:n}=t.getBoundingClientRect(),r=e-n,s=xe.findIndex(([d,E])=>r>=d&&r<=E);if(s===-1){console.error("No item found for click position:",r);return}let f=(j-s-1)*-1;re(f)},Me=e=>{var t,n;try{let r=(e instanceof MouseEvent?e.clientY:(n=(t=e.touches)==null?void 0:t[0])==null?void 0:n.clientY)||0,s=B.current;s.isClick&&Math.abs(r-s.startY)>5&&(s.isClick=!1),s.yList.push([r,Date.now()]),s.yList.length>5&&s.yList.shift();let f=(s.startY-r)/p,d=y.current+f;if(l)d=O(d);else{let E=u.length;d<0?d*=ue:d>E&&(d=E+(d-E)*ue)}s.touchScroll=$(d)}catch(r){console.error("Error in updateScrollDuringDrag:",r)}},se=e=>{var t;!I.current&&!((t=x.current)!=null&&t.contains(e.target))&&e.target!==x.current||(e.cancelable&&e.preventDefault(),u.length&&Me(e))},ae=e=>{var t,n,r;try{I.current=!0;let s=new AbortController,{signal:f}=s;F.current=s;let d={signal:f,passive:!1};(t=x.current)==null||t.addEventListener("touchmove",se,d),document.addEventListener("mousemove",se,d);let E=(e instanceof MouseEvent?e.clientY:(r=(n=e.touches)==null?void 0:n[0])==null?void 0:r.clientY)||0,w=B.current;w.startY=E,w.yList=[[E,Date.now()]],w.touchScroll=y.current,w.isClick=!0,H()}catch(s){console.error("Error in initiateDragGesture:",s)}},A=g.useCallback(e=>{var t;let n=I.current,r=!!((t=x.current)!=null&&t.contains(e.target))||e.target===x.current;(n||r)&&e.cancelable&&(e.preventDefault(),u.length&&ae(e))},[ae]),Le=e=>{let t=y.current,n=t,r=e>0?-K:K,s=0;if(l){s=Math.abs(e/r);let f=e*s+.5*r*s*s;n=Math.round(t+f)}else if(t<0||t>u.length-1){let f=U(t,0,u.length-1),d=t-f;r=pe,s=Math.sqrt(Math.abs(d/r)),e=r*s,e=t>0?-e:e,n=f}else{s=Math.abs(e/r);let f=e*s+.5*r*s*s;n=Math.round(t+f),n=U(n,0,u.length-1);let d=n-t;s=Math.sqrt(Math.abs(d/r))}ne(t,n,s,()=>{T(y.current)}),T(y.current)},ie=()=>{var e,t,n,r;try{(e=F.current)==null||e.abort(),F.current=null;let s=B.current;if(s.isClick){Ee(s.startY);return}let f=s.yList,d=0;if(f.length>1){let E=f.length,[w,G]=(t=f[E-2])!=null?t:[0,0],[we,be]=(n=f[E-1])!=null?n:[0,0],le=be-G;if(le>0){let ce=(w-we)/p*1e3/le,Ce=Ge,je=ce>0?1:-1;d=Math.min(Math.abs(ce),Ce)*je}}y.current=(r=s.touchScroll)!=null?r:y.current,Le(d)}catch(s){console.error("Error in finalizeDragAndStartInertiaScroll:",s)}finally{I.current=!1}},R=g.useCallback(e=>{var t;if(!u.length)return;let n=I.current,r=!!((t=x.current)!=null&&t.contains(e.target))||e.target===x.current;(n||r)&&e.cancelable&&(e.preventDefault(),ie())},[ie]),oe=e=>{e.preventDefault();let t=Date.now();if(t-te.current<100)return;let n=Math.sign(e.deltaY);n&&(te.current=t,re(n))},V=g.useCallback(e=>{if(!u.length||!x.current)return;let t=I.current,n=x.current.contains(e.target)||e.target===x.current;(t||n)&&e.cancelable&&(e.preventDefault(),oe(e))},[oe]);return g.useEffect(()=>{let e=x.current;if(!e)return;let t={passive:!1};return e.addEventListener("touchstart",A,t),e.addEventListener("touchend",R,t),e.addEventListener("wheel",V,t),document.addEventListener("mousedown",A,t),document.addEventListener("mouseup",R,t),()=>{e.removeEventListener("touchstart",A),e.removeEventListener("touchend",R),e.removeEventListener("wheel",V),document.removeEventListener("mousedown",A),document.removeEventListener("mouseup",R)}},[R,A,V]),g.useEffect(()=>{ye(Y)},[Y,a,u]),_.createElement("div",{ref:x,"data-rwp":!0,style:{height:me}},_.createElement("ul",{ref:q,"data-rwp-options":!0},ve),_.createElement("div",{className:v?.highlightWrapper,"data-rwp-highlight-wrapper":!0,"data-slot":"highlight-wrapper",style:{height:p,lineHeight:`${p}px`}},_.createElement("ul",{ref:Q,"data-rwp-highlight-list":!0,style:{top:l?-p:void 0}},_e)))}const Je=window.innerWidth*12/100,Ke=({options:i,value:a,onValueChange:c})=>h.jsx(Xe,{children:h.jsx(Ze,{options:i,optionItemHeight:Je,value:a,onValueChange:c})}),et="_container_2n9kh_1",tt="_item_2n9kh_5",nt="_itemActive_2n9kh_15",X={container:et,item:tt,itemActive:nt},rt=({options:i,value:a,onChange:c})=>h.jsx("div",{className:X.container,children:i.map(o=>h.jsx("div",{className:D(X.item,a===o.value&&X.itemActive),onClick:()=>c(o.value),children:o.label},o.value))}),st="_container_1hfgr_1",at="_containerLoading_1hfgr_12",it="_image_1hfgr_23",ot="_imageLoaded_1hfgr_32",W={container:st,containerLoading:at,image:it,imageLoaded:ot},lt=({image:i,title:a,placeholder:c})=>{const[o,l]=g.useState(i),[m,M]=g.useState(!0);return h.jsx("div",{className:D(W.container,m&&W.containerLoading),children:i&&h.jsx("img",{className:D(W.image,!m&&W.imageLoaded),src:o||i,alt:a,onLoad:()=>M(!1),onError:()=>{c?(M(!0),l(c)):M(!1)}})})},ct="_container_15bqk_1",ut="_title_15bqk_9",ht="_hide_15bqk_15",Z={container:ct,title:ut,hide:ht},dt=({isShow:i,question:a,value:c,setValue:o})=>{const l=a.options.map(m=>({label:m.text,value:m.id}));return h.jsxs("div",{className:D(Z.container,!i&&Z.hide),children:[a.image&&h.jsx(lt,{image:ke+a.image,title:a.text},a.id),h.jsx("p",{className:Z.title,children:a.text}),a.type==="MULTI_CHOICE"&&h.jsx(Ke,{onValueChange:o,options:l,value:c}),a.type==="SINGLE_CHOICE"&&h.jsx(rt,{value:c,options:l,onChange:o})]})},gt="_container_1vp68_1",ft="_content_1vp68_40",he={container:gt,content:ft},mt=document.getElementById("footer"),pt=({disabled:i,isDone:a,onClick:c})=>Ne.createPortal(h.jsx("div",{className:he.container,children:h.jsx("div",{className:he.content,children:h.jsx(Ie,{onClick:c,disabled:i,before:!a&&h.jsx(Pe,{}),after:a&&h.jsx(Ye,{}),children:a?"Поделиться":"Назад"})})}),mt),vt="_container_hzhez_1",_t="_content_hzhez_14",de={container:vt,content:_t},ge=300,xt="1";function Et(){const{id:i}=Se(),{data:a}=$e(i),[c,o]=g.useState(!1),[l,m]=g.useState(0),[M,k]=g.useState(!1),[S,v]=g.useState([]),b=()=>{if(!c){if(l===(a?.questions?.length||0)-1){k(!0);return}o(!0),setTimeout(()=>{o(!1),m(C=>C+1)},ge)}},Y=()=>{c||l!==0&&(o(!0),setTimeout(()=>{o(!1),m(C=>C-1)},ge))},N=a?.questions?.[l];if(!N)return null;const u=C=>{b(),v(L=>({...L,[N.id]:{value:C}}))},p=S[N.id];return h.jsx(Ae,{withNavigation:!1,children:h.jsxs("div",{className:de.container,children:[h.jsxs("div",{className:de.content,children:[h.jsx(Fe,{step:l,isShow:!M,length:a?.questions?.length||0}),h.jsx(dt,{isShow:!c&&!M,value:p?.value||"",setValue:u,question:N})]}),h.jsx(pt,{id:xt,isDone:M,disabled:l===0,onClick:M?b:Y})]})})}export{Et as default};

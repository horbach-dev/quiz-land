import{c as J,r as d,k as fe,j as h,l as D,M as _,f as Ne,B as Ie,m as Se,n as $e,P as Re}from"./index-CGeCadpN.js";const Ae=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],Pe=J("chevrons-left",Ae);const De=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],Ye=J("chevrons-right",De);const He=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],qe=J("flag",He),Te="_progressWrap_1ul4k_1",ze="_progressCount_1ul4k_30",We="_progressIcon_1ul4k_38",Be="_progress_1ul4k_1",Qe="_progressTrack_1ul4k_52",Fe="_hide_1ul4k_62",S={progressWrap:Te,progressCount:ze,progressIcon:We,progress:Be,progressTrack:Qe,hide:Fe},Oe=document.getElementById("header"),Ve=({isShow:i=!0,step:a,length:c})=>{const o=d.useRef(null),l=`${a/c*100}%`;return d.useLayoutEffect(()=>{o?.current?.offsetHeight&&document.documentElement.style.setProperty("--quiz-progress-page-header-height",o.current.offsetHeight+"px")},[]),fe.createPortal(h.jsxs("div",{ref:o,className:D(S.progressWrap,!i&&S.hide),children:[h.jsxs("div",{className:S.progressCount,children:[a+1," / ",c]}),h.jsx("div",{className:S.progress,children:h.jsx("div",{style:{width:l},className:S.progressTrack})}),h.jsx(qe,{className:S.progressIcon})]}),Oe)};function me(i){let a=_.useRef(i);return _.useEffect(()=>{a.current=i}),_.useMemo(()=>(...c)=>{var o;return(o=a.current)==null?void 0:o.call(a,...c)},[])}function Ge({defaultProp:i,onChange:a}){let c=_.useState(i),[o]=c,l=_.useRef(o),m=me(a);return _.useEffect(()=>{l.current!==o&&(m(o),l.current=o)},[o,l,m]),c}function Ue({prop:i,defaultProp:a,onChange:c=()=>{}}){let[o,l]=Ge({defaultProp:a,onChange:c}),m=i!==void 0,L=m?i:o,j=me(c),$=_.useCallback(v=>{if(m){let C=typeof v=="function"?v(i):v;C!==i&&j(C)}else l(v)},[m,i,l,j]);return[L,$]}var ue=.3,Xe=30,Ze=i=>Math.pow(i-1,3)+1,U=(i,a,c)=>Math.max(a,Math.min(i,c)),Je=({className:i,children:a})=>_.createElement("div",{className:i,"data-rwp-wrapper":!0},a);function Ke({defaultValue:i,value:a,onValueChange:c,options:o,infinite:l=!1,visibleCount:m=20,dragSensitivity:L=3,scrollSensitivity:j=5,optionItemHeight:$=30,classNames:v}){var C;let[Y=(C=o[0])==null?void 0:C.value,N]=Ue({defaultProp:i,prop:a,onChange:c}),u=d.useMemo(()=>{if(!l)return o;let e=[],t=Math.ceil(m/2);if(o.length===0)return e;for(;e.length<t;)e.push(...o);return e},[m,o,l]),p=$,w=p*.5,M=360/m,H=p/Math.tan(M*Math.PI/180),pe=Math.round(H*2+p*.25),b=m>>2,K=L*10,ve=10,x=d.useRef(null),q=d.useRef(null),B=d.useRef(null),y=d.useRef(0),ee=d.useRef(0),I=d.useRef(!1),te=d.useRef(0),Q=d.useRef({startY:0,yList:[],touchScroll:0,isClick:!0}),F=d.useRef(null),_e=d.useMemo(()=>{let e=(n,r,s)=>_.createElement("li",{key:r,className:v?.optionItem,"data-slot":"option-item","data-rwp-option":!0,"data-index":r,style:{top:-w,height:p,lineHeight:`${p}px`,transform:`rotateX(${s}deg) translateZ(${H}px)`,visibility:"hidden"}},n.label),t=u.map((n,r)=>e(n,r,-M*r));if(l)for(let n=0;n<b;++n){let r=-n-1,s=n+u.length;t.unshift(e(u[u.length-n-1],r,M*(n+1))),t.push(e(u[n],s,-M*s))}return t},[p,w,l,M,u,b,H,v?.optionItem]),xe=d.useMemo(()=>{let e=(n,r)=>_.createElement("li",{key:r,className:v?.highlightItem,"data-slot":"highlight-item","data-rwp-highlight-item":!0,style:{height:p}},n.label),t=u.map((n,r)=>e(n,r));if(l){let n=u[0],r=u[u.length-1];t.unshift(e(r,"infinite-start")),t.push(e(n,"infinite-end"))}return t},[v?.highlightItem,p,l,u]),ye=d.useMemo(()=>{let e=0,t=Math.PI/180,n=[];for(let r=b-1;r>=-b+1;--r){let s=r*M,f=p*Math.cos(s*t),g=e;e+=f,n.push([g,e])}return n},[M,p,b]),O=e=>(e%u.length+u.length)%u.length,R=e=>{let t=l?O(e):e;if(q.current){let n=`translateZ(${-H}px) rotateX(${M*t}deg)`;q.current.style.transform=n,q.current.childNodes.forEach(r=>{let s=r,f=Math.abs(Number(s.dataset.index)-t);s.style.visibility=f>b?"hidden":"visible"})}return B.current&&(B.current.style.transform=`translateY(${-t*p}px)`),t},T=()=>{cancelAnimationFrame(ee.current)},ne=(e,t,n,r)=>{if(e===t||n===0){R(e);return}let s=performance.now(),f=t-e,g=E=>{let k=(E-s)/1e3;if(k<n){let G=Ze(k/n);y.current=R(e+G*f),ee.current=requestAnimationFrame(g)}else T(),y.current=R(t),r?.()};requestAnimationFrame(g)},z=e=>{let t=O(e)|0,n=l?t:Math.min(Math.max(t,0),u.length-1);if(!l&&n!==e)return;y.current=R(n);let r=u[y.current];N(r.value)},Ee=e=>{let t=u.findIndex(n=>n.value===e);if(t===-1){console.error("Invalid value selected:",e);return}T(),z(t)},re=e=>{let t=y.current,n=t+e;l?n=Math.round(n):n=U(Math.round(n),0,u.length-1);let r=Math.abs(n-t);if(r===0)return;let s=Math.sqrt(r/j);T(),ne(t,n,s,()=>{z(y.current)})},Le=e=>{let t=x.current;if(!t){console.error("Container reference is not set.");return}let{top:n}=t.getBoundingClientRect(),r=e-n,s=ye.findIndex(([g,E])=>r>=g&&r<=E);if(s===-1){console.error("No item found for click position:",r);return}let f=(b-s-1)*-1;re(f)},Me=e=>{var t,n;try{let r=(e instanceof MouseEvent?e.clientY:(n=(t=e.touches)==null?void 0:t[0])==null?void 0:n.clientY)||0,s=Q.current;s.isClick&&Math.abs(r-s.startY)>5&&(s.isClick=!1),s.yList.push([r,Date.now()]),s.yList.length>5&&s.yList.shift();let f=(s.startY-r)/p,g=y.current+f;if(l)g=O(g);else{let E=u.length;g<0?g*=ue:g>E&&(g=E+(g-E)*ue)}s.touchScroll=R(g)}catch(r){console.error("Error in updateScrollDuringDrag:",r)}},se=e=>{var t;!I.current&&!((t=x.current)!=null&&t.contains(e.target))&&e.target!==x.current||(e.cancelable&&e.preventDefault(),u.length&&Me(e))},ae=e=>{var t,n,r;try{I.current=!0;let s=new AbortController,{signal:f}=s;F.current=s;let g={signal:f,passive:!1};(t=x.current)==null||t.addEventListener("touchmove",se,g),document.addEventListener("mousemove",se,g);let E=(e instanceof MouseEvent?e.clientY:(r=(n=e.touches)==null?void 0:n[0])==null?void 0:r.clientY)||0,k=Q.current;k.startY=E,k.yList=[[E,Date.now()]],k.touchScroll=y.current,k.isClick=!0,T()}catch(s){console.error("Error in initiateDragGesture:",s)}},A=d.useCallback(e=>{var t;let n=I.current,r=!!((t=x.current)!=null&&t.contains(e.target))||e.target===x.current;(n||r)&&e.cancelable&&(e.preventDefault(),u.length&&ae(e))},[ae]),ke=e=>{let t=y.current,n=t,r=e>0?-K:K,s=0;if(l){s=Math.abs(e/r);let f=e*s+.5*r*s*s;n=Math.round(t+f)}else if(t<0||t>u.length-1){let f=U(t,0,u.length-1),g=t-f;r=ve,s=Math.sqrt(Math.abs(g/r)),e=r*s,e=t>0?-e:e,n=f}else{s=Math.abs(e/r);let f=e*s+.5*r*s*s;n=Math.round(t+f),n=U(n,0,u.length-1);let g=n-t;s=Math.sqrt(Math.abs(g/r))}ne(t,n,s,()=>{z(y.current)}),z(y.current)},oe=()=>{var e,t,n,r;try{(e=F.current)==null||e.abort(),F.current=null;let s=Q.current;if(s.isClick){Le(s.startY);return}let f=s.yList,g=0;if(f.length>1){let E=f.length,[k,G]=(t=f[E-2])!=null?t:[0,0],[Ce,we]=(n=f[E-1])!=null?n:[0,0],le=we-G;if(le>0){let ce=(k-Ce)/p*1e3/le,be=Xe,je=ce>0?1:-1;g=Math.min(Math.abs(ce),be)*je}}y.current=(r=s.touchScroll)!=null?r:y.current,ke(g)}catch(s){console.error("Error in finalizeDragAndStartInertiaScroll:",s)}finally{I.current=!1}},P=d.useCallback(e=>{var t;if(!u.length)return;let n=I.current,r=!!((t=x.current)!=null&&t.contains(e.target))||e.target===x.current;(n||r)&&e.cancelable&&(e.preventDefault(),oe())},[oe]),ie=e=>{e.preventDefault();let t=Date.now();if(t-te.current<100)return;let n=Math.sign(e.deltaY);n&&(te.current=t,re(n))},V=d.useCallback(e=>{if(!u.length||!x.current)return;let t=I.current,n=x.current.contains(e.target)||e.target===x.current;(t||n)&&e.cancelable&&(e.preventDefault(),ie(e))},[ie]);return d.useEffect(()=>{let e=x.current;if(!e)return;let t={passive:!1};return e.addEventListener("touchstart",A,t),e.addEventListener("touchend",P,t),e.addEventListener("wheel",V,t),document.addEventListener("mousedown",A,t),document.addEventListener("mouseup",P,t),()=>{e.removeEventListener("touchstart",A),e.removeEventListener("touchend",P),e.removeEventListener("wheel",V),document.removeEventListener("mousedown",A),document.removeEventListener("mouseup",P)}},[P,A,V]),d.useEffect(()=>{Ee(Y)},[Y,a,u]),_.createElement("div",{ref:x,"data-rwp":!0,style:{height:pe}},_.createElement("ul",{ref:q,"data-rwp-options":!0},_e),_.createElement("div",{className:v?.highlightWrapper,"data-rwp-highlight-wrapper":!0,"data-slot":"highlight-wrapper",style:{height:p,lineHeight:`${p}px`}},_.createElement("ul",{ref:B,"data-rwp-highlight-list":!0,style:{top:l?-p:void 0}},xe)))}const et=window.innerWidth*12/100,tt=({options:i,value:a,onValueChange:c})=>h.jsx(Je,{children:h.jsx(Ke,{options:i,optionItemHeight:et,value:a,onValueChange:c})}),nt="_container_2n9kh_1",rt="_item_2n9kh_5",st="_itemActive_2n9kh_15",X={container:nt,item:rt,itemActive:st},at=({options:i,value:a,onChange:c})=>h.jsx("div",{className:X.container,children:i.map(o=>h.jsx("div",{className:D(X.item,a===o.value&&X.itemActive),onClick:()=>c(o.value),children:o.label},o.value))}),ot="_container_1hfgr_1",it="_containerLoading_1hfgr_12",lt="_image_1hfgr_23",ct="_imageLoaded_1hfgr_32",W={container:ot,containerLoading:it,image:lt,imageLoaded:ct},ut=({image:i,title:a,placeholder:c})=>{const[o,l]=d.useState(i),[m,L]=d.useState(!0);return h.jsx("div",{className:D(W.container,m&&W.containerLoading),children:i&&h.jsx("img",{className:D(W.image,!m&&W.imageLoaded),src:o||i,alt:a,onLoad:()=>L(!1),onError:()=>{c?(L(!0),l(c)):L(!1)}})})},ht="_container_15bqk_1",dt="_title_15bqk_9",gt="_hide_15bqk_15",Z={container:ht,title:dt,hide:gt},ft=({isShow:i,question:a,value:c,setValue:o})=>{const l=a.options.map(m=>({label:m.text,value:m.id}));return h.jsxs("div",{className:D(Z.container,!i&&Z.hide),children:[a.image&&h.jsx(ut,{image:Ne+a.image,title:a.text},a.id),h.jsx("p",{className:Z.title,children:a.text}),a.type==="MULTI_CHOICE"&&h.jsx(tt,{onValueChange:o,options:l,value:c}),a.type==="SINGLE_CHOICE"&&h.jsx(at,{value:c,options:l,onChange:o})]})},mt="_container_1vp68_1",pt="_content_1vp68_40",he={container:mt,content:pt},vt=document.getElementById("footer"),_t=({disabled:i,isDone:a,onClick:c})=>fe.createPortal(h.jsx("div",{className:he.container,children:h.jsx("div",{className:he.content,children:h.jsx(Ie,{onClick:c,disabled:i,before:!a&&h.jsx(Pe,{}),after:a&&h.jsx(Ye,{}),children:a?"Поделиться":"Назад"})})}),vt),xt="_container_1ldmx_1",yt="_content_1ldmx_20",de={container:xt,content:yt},ge=300,Et="1";function Mt(){const{id:i}=Se(),{data:a}=$e(i),[c,o]=d.useState(!1),[l,m]=d.useState(0),[L,j]=d.useState(!1),[$,v]=d.useState([]),C=()=>{if(!c){if(l===(a?.questions?.length||0)-1){j(!0);return}o(!0),setTimeout(()=>{o(!1),m(w=>w+1)},ge)}},Y=()=>{c||l!==0&&(o(!0),setTimeout(()=>{o(!1),m(w=>w-1)},ge))},N=a?.questions?.[l];if(!N)return null;const u=w=>{C(),v(M=>({...M,[N.id]:{value:w}}))},p=$[N.id];return h.jsx(Re,{withNavigation:!1,children:h.jsxs("div",{className:de.container,children:[h.jsxs("div",{className:de.content,children:[h.jsx(Ve,{step:l,isShow:!L,length:a?.questions?.length||0}),h.jsx(ft,{isShow:!c&&!L,value:p?.value||"",setValue:u,question:N})]}),h.jsx(_t,{id:Et,isDone:L,disabled:l===0,onClick:L?C:Y})]})})}export{Mt as default};

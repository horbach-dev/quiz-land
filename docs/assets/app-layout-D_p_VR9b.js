import{r as a,J as L,u as w,j as n,a as O,C as g,n as _,m as j,b as A,O as P,S as R}from"./index-UPycLL-e.js";import{c as E,u as I,a as S,b as x,n as T}from"./Button-B4QhbFUk.js";import{C as k}from"./circle-check-big-BMXl_lHk.js";import{r as z}from"./index-CEkgxZNq.js";import{u as $,r as M}from"./popupStore-C5nNLdf-.js";import{B as W}from"./Background-C9rRV-Hj.js";function b(e){return a.useMemo(()=>L(),[e])}const X=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],B=E("chevron-left",X);const H=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],q=E("house",H);const V=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Y=E("user",V),D=[{id:1,title:"navigation.main",icon:q,link:"/"},{id:2,title:"navigation.quizzes",icon:k,link:"/quizzes"},{id:3,title:"navigation.profile",icon:Y,link:"/profile"}],F="_container_zrlhr_1",G="_list_zrlhr_16",J="_hide_zrlhr_51",U="_item_zrlhr_55",K="_active_zrlhr_84",Q="_icon_zrlhr_88",l={container:F,list:G,hide:J,item:U,active:K,icon:Q},Z=()=>{const{t:e}=I(),t=a.useRef(null),o=S(s=>s.isNavigationVisible),{pathname:r}=w();return a.useLayoutEffect(()=>{t?.current?.offsetHeight&&document.documentElement.style.setProperty("--navigation-height",t.current.offsetHeight+"px")},[]),n.jsx("div",{className:x(l.container,!o&&l.hide),children:n.jsx("div",{ref:t,className:l.list,children:D.map(({id:s,link:c,title:i,icon:f})=>{const h=r.includes(c)&&c!=="/"||r===c;return n.jsxs("button",{type:"button",className:x(l.item,h&&l.active),onClick:()=>T(c),children:[n.jsx(f,{className:l.icon}),e(i)]},s)})})})},tt="_popup_zz4ur_1",et="_popupOverlay_zz4ur_11",nt="_popupWrap_zz4ur_21",ot="_popupContent_zz4ur_32",st="_popupClose_zz4ur_42",rt="_popupOpen_zz4ur_50",p={popup:tt,popupOverlay:et,popupWrap:nt,popupContent:ot,popupClose:st,popupOpen:rt},ct=300,at=({isOpen:e,children:t,onClose:o})=>{const[r,s]=a.useState(!1);return a.useEffect(()=>{e?(document.body.style.overflow="hidden",s(!0)):(document.body.style.overflow="",setTimeout(()=>s(!1),ct))},[e]),r?n.jsxs("div",{className:x(p.popup,e?p.popupOpen:p.popupClose),children:[n.jsx("div",{className:p.popupOverlay,onClick:o}),n.jsx("div",{className:p.popupWrap,children:n.jsx("div",{className:p.popupContent,children:t})})]}):null},it=document.getElementById("modals"),ut=()=>{const e=$(t=>t.popups);return z.createPortal(e.toSorted((t,o)=>t.lastOpen-o.lastOpen).map(({name:t,isOpen:o,close:r,params:s})=>{const c=M[t];return c?n.jsx(at,{isOpen:o,onClose:()=>s?.overlayClose?r():null,children:n.jsx(c,{close:r,...s})},t):null}),it)},lt=(e,t=300)=>{let o;return(...r)=>{clearTimeout(o),o=setTimeout(()=>e(...r),t)}},N=()=>({width:window.innerWidth,height:window.innerHeight}),pt=()=>{const[e,t]=a.useState(N);return a.useEffect(()=>{const o=lt(()=>t(N));return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[]),e},dt="_container_1xqeb_1",mt={container:dt},ft=document.getElementById("modals"),ht=()=>{const{width:e,height:t}=pt();return t>e+t/4?null:z.createPortal(n.jsx("div",{className:mt.container,children:n.jsxs("p",{children:["Пожалуйста ",n.jsx("br",{})," поверните устройство"]})}),ft)},d=document.getElementById("root"),y=85,m=20,vt=(e,t)=>{a.useEffect(()=>{if(!t)return;let o=0,r=0,s=0,c=0;function i(u){r=u.touches[0].clientX,o=u.touches[0].clientY,s=0,c=0}function f(u){if(s=u.touches[0].clientX,c=u.touches[0].clientY,e.current){e.current.style.transition="none";const v=s-r-Math.abs(c-o)-m;if(v<m)e.current.style.transform=`translateX(${v}px)`;else{const C=Math.min((v-m)*2,y);e.current.style.transform=`scale(${C/(y*2)+1}) translateX(${m}px)`}}}function h(){if(e.current&&(e.current.style.transition="transform 0.3s",e.current.style.transform="translateX(0) scale(1)"),s===0)return;const u=s-r-Math.abs(c-o)-m;Math.abs(u)>y&&u>0&&t&&t(),r=0,o=0,s=0,c=0}return d.addEventListener("touchstart",i),d.addEventListener("touchmove",f),d.addEventListener("touchend",h),()=>{d.removeEventListener("touchstart",i),d.removeEventListener("touchmove",f),d.removeEventListener("touchend",h)}},[t])},_t="_container_1umyf_1",yt={container:_t},xt=document.getElementById("swipe"),Et=()=>{const e=S(o=>o.swipeRedirectCallback),t=a.useRef(null);return vt(t,e),z.createPortal(n.jsx("div",{className:yt.container,ref:t,children:n.jsx(B,{})}),xt)};function zt(){const[e,t]=a.useState(!1),{tgWebAppStartParam:o}=b(),r=O(),{pathname:s}=w();function c({detail:i}){i?.pathname!==s&&i?.pathname&&r(i.pathname==="back-navigate"?-1:i.pathname)}return a.useEffect(()=>{o&&!e&&(t(!0),r(`quiz/${o}`))},[o,e,r]),a.useEffect(()=>(document.addEventListener(g,c),()=>{document.removeEventListener(g,c)}),[s]),{pathname:s}}const gt=["ios","android"];function jt(){const{tgWebAppPlatform:e}=b(),t=gt.includes(e);return a.useLayoutEffect(()=>{_?.isSupported()&&(_?.mount(),_?.disableVertical()),t&&j.requestFullscreen?.isAvailable()&&j.requestFullscreen()},[t]),{isMobile:t}}const Nt="_layout_1gu4l_1",wt={layout:Nt};function Pt(){A();const{pathname:e}=zt(),{isMobile:t}=jt();return n.jsxs(n.Fragment,{children:[n.jsx(W,{}),n.jsx("div",{className:wt.layout,children:n.jsx(P,{})}),n.jsx(R,{}),n.jsx(Z,{}),e!=="/"&&n.jsx(Et,{}),t&&e!=="/create"&&n.jsx(ht,{}),n.jsx(ut,{})]})}export{Pt as default};
